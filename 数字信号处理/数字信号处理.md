

![img](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/14512145-1c09385cdd8fc81e.png)

# 第一章 离散信号与系统分析

## 1.1 离散时间信号

单位脉冲序列
$$
\delta[k] = \begin{cases}1, k = 0\\ 0, k\neq 0 \end{cases}
$$
单位阶跃序列
$$
u[k] = \begin{cases}1, k\leq 0\\ 0,k<0 \end{cases}
$$
卷积运算
$$
y[k] = x_{1}[k]*x_{2}[k] = \sum_{n = -\infty}^{\infty}{x_{1}[n]x_{2}[k-n]}
$$
翻转再平移，乘积求和累加。

序列互相关运算
$$
r_{xy}[k] = \sum_{k = -\infty}^{\infty}{x[k]y[k+n]}
$$
序列的自相关函数是偶函数。

## 1.2 离散时间系统

### 1.2.1 系统分类

1. 线性系统

$$
T\{ax_{1}[k]+bx_{2}[k]\}=ay_{1}[k]+by_{2}[k]
$$

2. 非时变系统

$$
   T\{x[k-n] \}=y[k-n]
$$

3. 因果系统

   系统在$k_{0}$的输出只与$k_{0}$时刻及以前的输入有关。

4. 稳定系统

   输入有界，输出也有界。

### 1.2.2 离散LTI系统的时域描述及特性

系统的单位脉冲响应

$$
h[k] = T\{\delta[k] \}
$$

也就是信号与系统中描述的 系统信号。

离散LTI系统稳定的充要条件：输入有界，输出有界。

## 1.3 离散时间信号的频域分析

### 1.3.1 离散Fourier级数(DFS)

针对周期离散序列。

类似于三角函数的叠加之和，用虚数表示。

将一个周期变换即可。
$$
\tilde{X}[m] = DFS\{\tilde{x}[k]\} = \sum_{k = <N>}{\tilde{x}[k]}{W_{N}^{mk}}
$$

$$
\tilde{x}[k] = IDFS\{\tilde{X}[k] \} = {{1}\over{N}}\sum_{m = <N>}{\tilde{X}[m]}{W_{N}^{-mk}}
$$

$$
W_{N} = e^{-j{{2\pi}\over{N}}}
$$



> 大写的$X$是变换后。
>
> $N$ 是周期序列的周期。$m$是变换后的变量。 $k$是周期序列的变量。
>
> $ {{2\pi\over{N}}}$ 相当于把三角的周期与序列的周期联系起来。

#### 性质

* 线性

  不赘述

* 位移

  1. 时域
$$
     \tilde{x}[k+n]\xrightarrow{DFS} e^{j{{2\pi}\over{N}}mn}\tilde{X}[m]
$$

     > 时域的位移符合我们的感官，正负不变。

  2. 频域
$$
     e^{-j{{2\pi}\over{N}}lk}\xrightarrow{DFS} \tilde{X}[m+l]
$$

     > 频域的位移符号则相反。

* 对称

$$
若\ \ \ \  \tilde{x}[k] \xrightarrow{DFS} \tilde{X}[m]\\
则 \ \ \ \tilde{x}^{*}[k] \xrightarrow{DFS} \tilde{X}[-m]\\
\tilde{x}^{*}[-k] \xrightarrow{DFS} \tilde{X}[m]
$$

> 原本是$k\leftrightarrow m$
>
> 对称后，也就是共轭，$-k \leftrightarrow m$和$k \leftrightarrow -m$

* 周期卷积

时域
$$
\tilde{{x}_{1}}[k]*\tilde{{x}_{2}}[k] \xrightarrow{DFS} \tilde{{X}_{1}}[m]·\tilde{{X}_{2}}[m]
$$

> 时域卷积就是频域乘积。（应用较多）

频域
$$
\tilde{{x}_{1}}[k]·\tilde{{x}_{2}}[k] \xrightarrow{DFS} {{1}\over{N}}\tilde{{X}_{1}}[m]*\tilde{{X}_{2}}[m]
$$

> 频域卷积在一个周期上的表现就是时域乘积。（应用较少）

* Parseval(帕塞瓦尔)等式（能量守恒）

$$
\sum_{k = <N>}{|\tilde{x}[k]|^{2}} = {{1}\over{N}} {\sum_{ m = <N>}{|\tilde{X}[m]|^{2}}}
$$



### 1.3.2 离散时间Fourier变换(DTFT)

针对非周期离散序列。
$$
X(e^{j\Omega}) =DTFT\{x[k] \}= \sum_{k = -\infty}^{\infty}{x[k]e^{-j\Omega k}}
$$

$$
x[k] = IDTFT\{X(e^{j\Omega}) \}= {{1}\over{2\pi}}{\int_{\Omega = <2\pi>}}{X(e^{j\Omega})e^{j\Omega k}d\Omega}
$$

也可以将频域函数用其他形式表示
$$
X(e^{j\Omega}) = X_{r}(e^{j\Omega})+jX_{j}(e^{j\Omega})
$$

$$
X(e^{j\Omega}) = |X(e^{j\Omega})|e^{j\psi(\Omega)}
$$

> $|X(e^{j\Omega})|$ 是幅度谱，$\psi(\Omega)$ 是相位谱

#### 性质

$$
x[k] \xrightarrow{DTFT}{X(e^{j\Omega})}
$$


* 线性

  不赘述

* 位移

  时域
$$
  x[k+n] \xrightarrow{DTFT}e^{jn\Omega}X(e^{j\Omega})
$$

  > 同上，时域的平移，同号。
  >
  > 时域平移，在频域是相移。

  频域
$$
  e^{j\Omega_{0}k}x[k] \xrightarrow{DTFT} X(e^{j(\Omega - \Omega_{0})})
$$

  > 同上，频域平移，符号相反。
  >
  > 频域平移，时域上的相移。

* 对称

  > 对称，共轭后，$ k \leftrightarrow -\Omega$ ,$ -k \leftrightarrow \Omega$

* 卷积

  时域
$$
  {{x}_{1}}[k]*{{x}_{2}}[k] \xrightarrow{DTFT} {{X}_{1}}(e^{j\Omega})·{{X}_{2}}(e^{j\Omega})
$$
  频域
$$
  {{x}_{1}}[k]{{x}_{2}}[k] \xrightarrow{DTFT} {{1}\over{2\pi}}\int_{<2\pi>}{{X}_{1}}(e^{j\theta})·{{X}_{2}}(e^{j(\Omega-\theta)})d\theta = {{1}\over{2\pi}}{{X}_{1}}(e^{j\Omega})*{{X}_{2}}(e^{j\Omega})
$$

* 频域微分
$$
  k·x[k] \xrightarrow{DTFT} j{{dX(e^{j\Omega})}\over{d\Omega}}
$$

* Parseval能量守恒定理
$$
  \sum_{k}{|x[k]|^{2}} = {{1}\over{2\pi}}{\int_{<2\pi>}|X(e^{j\Omega})|^{2}d\Omega}
$$


## 1.4 离散时间系统的频域分析

### 1.4.1 离散系统的描述

$$
H(e^{j\Omega}) = {{Y_{zs}(e^{j\Omega})}\over{X(e^{j\Omega})}}
$$

>  $H(e^{j\Omega})$ 是系统频率响应。与$h[k]$互为傅里叶变换。
>
> 也可变换为幅度与相位形式。
> $$
> H(e^{j\Omega}) = |H(e^{j\Omega})|e^{j\psi(\Omega)}
> $$
> 因为频率响应基本是复函数形式，故可转换，一个为幅度响应，一个为相位响应。

当离散系统稳定是，频率响应肯定存在。

### 1.4.2 离散非周期序列通过系统响应的频域分析

当$x[k] = e^{j\Omega k}$ ，即输入是 角频率为$\Omega$的虚指数信号时。
$$
y_{zs}[k] = e^{j\Omega k}*h[k] = \sum_{n = -\infty}^{\infty}{e^{j\Omega (k-n)}h[n]}=e^{j\Omega k}H(e^{j\Omega})
$$

> 输入为虚指数信号时，输出也为同频率的虚指数信号。
>
> 只是幅度和相位有系统频率响应而定。


$$
Y_{zs}(e^{j\Omega}) = H(e^{j\Omega})X(e^{j\Omega})
$$


### 1.4.3 离散周期序列通过系统响应的频域分析

根据DFS
$$
\widetilde{y}[k] = {{1}\over{N}}{\sum_{m =0}^{N-1}}\widetilde{X}[m]H(e^{j{{2\pi}\over{N}}m})e^{j{{2\pi}\over{N}}mk}
$$
 即，离散周期序列可以表示为一系列虚指数信号之和，所以通过系统后，仍为虚指数信号，仅仅幅度和相位发生改变。

且由频率响应函数决定，化成幅度相位形式更容易转换。例如：
$$
H(e^{j\Omega}) = |H(e^{j\Omega})|e^{j\psi(\Omega)} \\
e^{j(\Omega_{0}k+\theta)}\longleftrightarrow |H(e^{j\Omega_{0}})|e^{j(\Omega_{0}k+\theta)+j\psi(\Omega_{0})}\\
e^{-j(\Omega_{0}k+\theta)}\longleftrightarrow |H(e^{-j\Omega_{0}})|e^{-j(\Omega_{0}k+\theta)+j\psi(-\Omega_{0})}
$$

> 对正弦型信号，任然适用。

 在知道幅度变换和相位变换的情况下，求解会非常容易。

### 1.4.4 线性相位的离散LTI系统

相位响应函数是线性函数
$$
\Psi(\Omega) = -k_{0}\Omega
$$
延迟就是常数。

所以，如果某线性相位的LTI系统的幅度响应是常数，则可近似认为是一个无失真传输系统。

### 1.4.5 数字滤波器

低通滤波器
$$
h_{LP}[k] = {{1}\over{2\pi}}{\int_{-\pi}^{\pi}}{H_{LP}(e^{j\Omega})e^{j\Omega k}d\Omega}={{1}\over{2\pi}}{\int_{-\Omega_{c}}^{\Omega_{c}}e^{j\Omega k}d\Omega} = {{\Omega_{c}\over{\pi}}}Sa(\Omega_{c}k)
$$

> $\Omega_{c}$是低通高通的截频。

## 1.5 离散时间信号的复频域分析

针对某些系统不存在频率响应的情况，引入复频域分析。

也就是信号系统中的$\mathscr{Z}$变换。
$$
X(z) = \sum_{k = -\infty}^{\infty}x[k]z^{-k}= \mathscr{Z}\{x[k]\}
$$



| 序号 |    反因果序列、左边序列     |    收敛域    |                       象函数                       |  收敛域   |   因果序列、右边序列    |
| ---- | :-------------------------: | :----------: | :------------------------------------------------: | :-------: | :---------------------: |
| 1    |              /              |      /       |                         1                          |  全平面   |       $\delta[k]$       |
| 2    |              /              |      /       |                    $z^{-m},m>0$                    |  $|z|>0$  |      $\delta[k-m]$      |
| 3    |        $\delta[k+m]$        | $|z|<\infty$ |                    $z^{m},z>0$                     |     /     |            /            |
| 4    |         $-u[-k-1]$          |   $|z|<1$    |                 ${{z}\over{z-1}}$                  |  $|z|>1$  |         $u[k]$          |
| 5    |       $-a^{k}u[-k-1]$       |  $|z|<|a|$   |                 ${{z}\over{z-a}}$                  | $|z|>|a|$ |       $a^{k}u[k]$       |
| 6    |     $-ka^{k-1}u[-k-1]$      |  $|z|<|a|$   |              ${{z}\over{(z-a)^{2}}}$               | $|z|>|a|$ |     $ka^{k-1}u[k]$      |
| 7    | $-a^{k}sin(\beta k)u[-k-1]$ |  $|z|<|a|$   |   ${{azsin\beta}\over{z^{2}-2azcos\beta+a^{2}}}$   | $|z|>|a|$ | $a^{k}sin(\beta k)u[k]$ |
| 8    | $-a^{k}cos(\beta k)u[-k-1]$ |  $|z|<|a|$   | ${{z[z-acos\beta]}\over{z^{2}-2azcos\beta+a^{2}}}$ | $|z|>|a|$ | $a^{k}cos(\beta k)u[k]$ |

### 常用变换表

> 左边右边序列 通过极点判断，由于是复数频域下，故 -1 等也可以当作极点。

其余分析方法与信号系统中无异。

## 1.6 离散时间系统的复频域分析

$$
H(z) = {{Y_{zs}(z)}\over{X(z)}} = \mathscr{Z}\{h(k) \}
$$



## 1.7 全通滤波器与最小相位系统

两者都是物理可实现的因果稳定系统

全通滤波器：系统的幅度响应为常数的系统

最小相位系统：具有最小的延迟

### 1.7.1 一阶全通滤波器

一阶因果稳定的全通滤波器(all-pass filter)的系统函数定义为

$$
A_{1}(z) = {{z^{-1}-d^{*}}\over{1-dz^{-1}}}\ \ \ |d|<1
$$

频率响应为

$$
A_{1}(3^{j\Omega}) = e^{-j\Omega}{{1-d^{*}e^{j\Omega}}\over{1-de^{-j\Omega}}}
$$

> 由于分子分母共轭
> $$
> |A_{1}(e^{j\Omega})|=1
> $$

由于系统的福地响应恒为1，故为全通滤波器。

一阶全通滤波器的零点与极点互为**共轭倒数**关系。

### 1.7.2 m阶实系数全通滤波器

系数是实数。

* $p_{i}$是实数

若$p_{i}$是一个零点，则${1}\over{p_{i}}$必是一个极点。可以构成一个全通滤波器。

* $p_{i}$是复数

$p_{i}$和$(1/p_{i})^{*}$、$p_{i}^{*}$和$(1/p_{i})$是两对极点与零点，可以构成一个一阶全通滤波器。

其实不用分类，实数下的共轭就是本身，所以两对的情况在实数下就只有一对。

所以m阶实系数全通滤波器可以分解成m个一阶全通滤波器。

### 1.7.3 最小相位系统

针对因果稳定(系统函数极点都在单位圆内)离散系统而言，如果所有零点都在单位圆内，则成为最小相位系统，记为$H(z)_{min}$。反之，若零点都在单位圆外，则成为最大相位系统，记为$H(z)_{max}$。

### 应用

任一实系数因果稳定系统$H(z)$都可以表示为一个最小相位系统与一个全通滤波器系统级联。即

$$
H(z) = H_{min}(z) A_{m}(z)
$$

由于$A_{m}(z)$是全通系统，所以$H(z)$和$H_{min}(z)$具有相同的幅度响应。

$$
|H(z)|=|H_{min}(z)| \\
\psi(\Omega) = \psi_{min}(\Omega)+\psi_{A}(\Omega)\\
$$

#### 转化方法

1.先判断系统函数，是否极点都在单位圆内(才有资格转化)，零点哪些在单位圆外。
2.根据在外面的零点，极点为零点的共轭倒数，构建一个一阶全通滤波器。
3.就已知$H(z)$，$A_{m}(z)$，通过公式就可以求出$H_{min}(z)$。

## 1.8 信号时域抽样与信号重建

### 1.8.1 信号时域抽样



是将连续时域信号$x(t)$以间隔$T$进行等间隔抽样，得到相应的离散时间信号$x[k]$。

$$
x[k] = x(kT) = x(t)|_{t = kT},\ \  k \in Z
$$

称$T$为抽样间隔。抽样频率$f_{sam}$和角频率$\omega_{sam}$与抽样间隔关系为

$$
f_{sam} = {{1}\over{T}}\\
\omega_{sam} = 2\pi f_{sam}\\
$$

抽样间隔越小，失真也会越小，但在得到的序列样点就越多，处理离散信号的效率就降低。

抽样间隔越大，效率提高了，但是失真就严重。

在两者之间如何寻找平衡点呢？

从频域角度分析。

$$
X(j\omega) = \int_{-\infty}^{\infty}{x(t)e^{-j\omega t}dt}\\
X(e^{j\Omega}) = \sum_{k = -\infty}^{\infty}{x[k]e^{-j\Omega k}}\\
其中 x[k] = x(kT)，k\in Z，带入则有\\
X(e^{j\Omega}) = {{1}\over{T}}\sum_{n = -\infty}^{\infty}{X[j(\omega-n\omega_{sam})]},\ \omega_{sam}={{2\pi}\over{T}},\Omega = \omega T
$$

> 发现，在时域下的离散化，就是频域下的周期化。
> 倘若，抽样间隔太小或太大，就会造成频谱的混叠，从而引起失真。


得出结论
$$
f_{sam}\geq2f_{m}\\
\omega_{sam}\geq 2\omega_{m}
$$

> 抽样频率大于原信号最大频率的两倍，临界值称为**奈奎斯特频率**。



### 1.8.2 信号重建

将离散信号转换为连续信号，为时域抽样的逆过程。

#### 频域法

先将离散信号转换为连续时间信号，只在有值的时候受到冲击函数影响，其余时候为0。

$$
x_{rec}(t) = \sum_{k = -\infty}^{\infty}{x[k]\delta(t - kT)}
$$

此时，得到的类似于离散序列。已知它的频谱函数是连续信号频谱函数的周期化，故取其中一个周期就可以得到抽样前信号的频谱。

通过低通滤波器$H_{rec}(j\omega)$来实现。

$$
H_{rec}(j\omega) = \begin{cases}T, |\omega|\leq\omega_{sam}/2\\0,其他 \end{cases}
$$

#### 时域法

相同的方法，频域下的乘积就是时域下的卷积。

$$
x(t) = x_{rex}(t)*h_{rex}(t)\\
h_{rec}(t) = Sa({{\pi t}\over{T}})\\
$$

### 1.8.3 连续信号的离散处理

将连续信号$x(t)$以$T_{sam}$为间隔抽样得到离散信号$x[k]$；离散系统$h[k]$对离散信号$x[k]$进行处理后输出离散信号$y[k]$；离散信号$y[k]$以$T_{sam}$为间隔重建而得到连续信号$y(t)$。

> 重建后的信号只是和原信号近似，不论以何种方法，都不可能得到一样的原信号。



# 第二章 离散Fourier变换

## 2.1 有限长序列的Fourier分析

### 2.1.1 四种信号的Fourier分析

四种信号：连续周期信号$\tilde{x}(t)$，连续非周期信号$x(t)$，离散周期信号$\tilde{x}[k]$，离散非周期信号$x[k]$。四种信号的Fourier分析都是将时域信号表示为正弦(虚指数)信号。

$$
\tilde{x}(t) = \sum_{n = -\infty}^{\infty}{X(n\omega_{0})e^{jn\omega_{0}t}}\\
X(n\omega_{0}) = {{1}\over{T_{0}}}\int_{<T_{0}>}\tilde{x}(t)e^{-jn\omega_{0}t}\\
$$

> 其频谱为非周期的离散谱。$\omega_{0} = 2\pi /T_{0} = 2\pi f_{0}$为信号的基频，$n\omega_{0}$为信号的谐频。


$$
x(t) = {{1}\over{2\pi}}{\int_{-\infty}^{+\infty}X(j\omega)e^{j\omega t}d\omega}\\
X(j\omega) = \int_{-\infty}^{+\infty} x(t) e^{-j\omega t}dt\\
$$

> 非周期的连续谱
> 

$$
\tilde{x}[k] = IDFS\{\tilde{X}[m]\} = {{1}\over{N}}\sum_{m = 0}^{N-1}{\tilde{X}[m]e^{j{{2\pi}\over{N}}mk}}\\
\tilde{X}[m] = DFS\{x[k]\} = \sum_{ k = 0}^{N-1}{\tilde{x}[k]·e^{-j{{2\pi}\over{N}}mk}}\\
$$

> 周期的离散谱，周期为$N$。
> 
$$
x[k] = IDTFT\{X(e^{j\Omega})\} = {{1}\over{2\pi}}{\int_{<2\pi>}X(e^{j\Omega})e^{j\Omega k }d\Omega}\\
X(e^{j\Omega}) = DTFT\{x[k]\} = \sum_{ k = -\infty}^{\infty} {x[k]e^{-j\Omega k}}\\
$$

> 以$2\pi$为周期的连续谱。
> 

### 2.1.2 有限长序列的离散Fourier变换

时域的变化将会在频域中体现。

时域的离散化是频域的周期化。时域的周期化是频域的离散化。

## 2.2 离散Fourier变换的性质

假设
$$
X_{1}[m] = DFT\{x_{1}[k]\}\\
X_{2}[m] = DFT\{x_{2}[k]\}\\
$$

### 2.2.1 线性

$$
x[k] = ax_{1}[k] +b x_{2}[k]\\
DFT\{x[k]\} = X[m] = aX_{1}[m] +b_{2}[m]
$$

两序列应该长度一致，短的补0至相同。

### 2.2.2 循环位移特性

$$
y [k] = x[(k+n)_{N}]
$$

n为位移距离。N为循环周期，求模后的余数是移动后的结果。

$$
DFT\{x[(k+n)_{N}]\} = W_{N}^{-mn}X[m]\\
DFT\{W_{N}^{lk}x[k]\} = X[(m+l)_{N}]\\
$$

> 时域的循环位移对应频域的相移。

> 时域的相移对应频域的循环位移。

### 2.2.3 对称特性

周期**共轭对称**

$$
x[k] = x^{*}[(-k)_{N}]
$$

周期**共轭反对称**

$$
x[k] = -x^{*}[(-k)_{N}]
$$

在实序列下可分为，在一个周期内的奇偶对称情况:

周期**偶**对称

$$
x[k] = x[(-k)_{N}]
$$

周期**奇**对称

$$
x[k] = -x[(-k)_{N}]
$$

对称特性分三类情况研究

1. $x[k]$为有限长实序列

$$
有x[k] = x^{*}[k]\\
X[m] = X^{*}[(N-m)_{N}]\\
$$

将实部虚部分开计算，则易得，频谱的**实部周期偶对称，虚部周期奇对称**。

2. $x[k]$为有限长实序列,且满足周期偶对称

$$
X[m] = X^{*}[m]
$$

周期偶对称序列的频谱也是周期偶对称实序列。

3. $x[k]$为有限长实序列,且满足周期奇对称

$$
X[m] = -X^{*}[m]
$$

周期奇对称实序列的频谱是周期奇对称虚序列。

节约计算时间，或者用来校验结果是否正确。

### 2.2.4循环卷积特性

$$
x[k]\bigotimes h[k] =\sum_{n = 0}^{N-1}x[n]h[(k-n)_{N}]
$$

> 圆圈中写循环的周期。

> 序列的卷积可以有限长也可以无限长，周期循环卷积必须是有限长。

> 序列的卷积位移是线性位移，周期循环卷积的位移是循环位移

也可以用矩阵表示。

DFT下的时域卷积定理

$$
DFT\{x[k]\bigotimes h[k]\} = X[m]Y[m]\\
x[k]\bigotimes h[k] = IDFT\{DFT\{x[k]\}·DFT\{h[k]\}\}\\
\\
DFT\{x[k]·h[k]\} = {{1}\over{N}}X[m]\bigotimes H[m]\\
$$

由此可见，循环卷积可以通过DFT来计算，DFT存在快速算法。

### 2.2.5 Parsevel定理

$$
\sum_{k =0}^{N-1}|x[k]|^{2} = \sum_{k = 0}^{N-1}x[k]x^{*}[k] = {{1}\over{N}}\sum_{m =0}^{N-1}|X[m]|^{2}
$$

时域的能量等于频域的能量。

## 2.3 离散Fourier变换域z变化的关系

### 2.3.1 由序列z变换表示序列DFT

令$z_{m}=e^{j{{{2\pi}\over{N}}mk}}$，表示将单位圆$e^{j\Omega}$N等分。则有

$$
X(z_{m}) = \sum_{k = 0}^{N-1}x[k]z^{-k}|_{z = z_{m}}= \sum_{k = 0}^{N-1}x[k]e^{-j{{{2\pi}\over{N}}km}}
$$

### 2.3.2 由序列DFT表示序列z变换

略吧..应该不考

## 2.4 利用DFT计算线性卷积

###  2.4.1 两个有限长序列的线性卷积

计算$y[k] = x[k]*h[k]$，长度分别为$N_{1},N_{2}$，$y[k]$为$N_{1}+N_{2}-1$。

通过DFT来实现计算线性卷积，因为DFT存在快速算法，故可以提升效率。

先利用卷积的性质，将卷积计算变成频域乘积。即

$$
Y(e^{j\Omega}) = X(e^{j\Omega})·H(e^{j\Omega})
$$

其中$Y(e^{j\Omega})$是以$2\pi$为周期的连续谱，无法利用数字方法直接计算。

所以将$Y(e^{j\Omega})$在主值区间内$[0,2\pi)$等间隔L点，$L\geq N_{1}+N_{2}-1$。即

$$
Y_{L}[m] = Y(e^{j\Omega})|_{\Omega = {{2\pi}\over{L}}m}=X_{L}[m] ·H_{L}[m]，m = 0,1,2,…,M-1
$$

> $Y_{L}[m]$是$y[k]$的L点DFT(有限长离散傅里叶变换)。
> 
> $X_{L}[m]，H_{L}[m]$是$x[k],h[k]$补0后对应L点DFT。
> 
> 就可以通过DFT来计算了。
> 
#### 一般步骤

1. 将序列分别补0成为L点的有限序列。得到$x_{L}[k],H_{L}[k]$

2. 对上述序列分别进行L点DFT，相乘得到$Y_{L}[m]$。

3. 进行IDFT变换，得到$y[k]$。

根据循环卷积特性，可将$x[k],h[k]$线性卷积表达为序列$x_{L}[k],h_{L}[k]$的L点循环卷积。

$$
y[k] = x[k]*h[k] = x_{L}[k] \bigotimes h_{L}[k] ，L\geq N_{1}+N_{2}-1
$$

当两个序列长度接近时，采用DFT快速算法可以大幅提高运算效率。

### 2.4.2 长序列与短序列的线性卷积

采用分段卷积的方式，有以下两种方法。

#### 1. 重叠相加法

基本思想：将长序列分成若干个短序列，分段卷积再叠加。

实现过程：

先将长序列分解长度为L的短序列

$$
x[k] = \sum_{n = 0}^{\infty}x_{n}[k - nL]\\
x_{n}[k] = \begin{cases}x[k+nL]，0\geq k \geq L-1\\0\ \ \ \ \ \ \ \ \ \ \ \ \  \ \ ， 其他\\ \end{cases}
$$

再与长度为M的短序列$h[k]$分段线性卷积，可以通过循环卷积计算。(此时问题就是两个长序列的线性卷积了)

$$
y[k] = \sum_{n = 0}^{\infty}x_{n}[k-nL]*h[k] = \sum_{n = 0}^{\infty}y_{n}[k - nL]
$$

通过计算非0范围会发现，前后两端卷积序列会有M-1点需要重合叠加。

相当于分段的每次卷积都会在尾部多出来一部分，将多出来的部分和下一段的前端重合罢了。

这也是重叠相加法的命名由来。

#### 2. 重叠保留法

进行循环卷积，取出卷积部分，舍弃重叠部分。

准备工作和上一个方法一样，不同的是需要在第一个分段前添加M-1个0，每个分段都有前M-1个元素和上一分段相同。此后每个分段的前M-1个都需要抛弃(因为都是由循环卷积造成的叠加部分，不再是最初的卷积部分),最后拼接剩下的即可。

多出来的部分就不需要了，因为会在下一段重新卷积计算得到。

## 2.5 利用DFT分析连续非周期信号的频谱

要先将连续非周期信号离散化才可以进行DFT分析。通过建立$x[k],X[m]$和$x(t),X(e^{j\Omega})$之间的关系，就可以通过DFT性质来分析连续非周期信号的频谱。

### 2.5.1 连续非周期信号频谱与DFT关系



![信号频谱之间的关系](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E4%BF%A1%E5%8F%B7%E9%A2%91%E8%B0%B1%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB.jpg)



信号时域的离散化是频域的周期化。故有

$$
X(e^{j\Omega}) = {{1}\over{T}}\sum_{n = -\infty}^{\infty}X[j(\omega - n\omega_{sam})] = \widetilde{X}_{\omega_{sam}}(j\omega) ，\Omega = \omega T,\omega_{sam} = {{2\pi}\over{T}}=2\pi f_{sam}
$$

而$X[m]$为$X(e^{j\Omega})$再一个周期$[0,2\pi)$上等间隔的抽样，即

$$
X[m] = X(e^{j\Omega})|_{\Omega = {{2\pi}\over{N}}m}，m = 0,1,2,…,N-1
$$

将上式带入即可得到，信号的频谱和信号离散化后DFT之间的关系，

$$
X[m] = X[m] = X(e^{j\Omega})|_{\Omega = {{2\pi}\over{N}}m} =\widetilde {X}_{\omega_{sam}}(j\omega)|_{\omega = {{\omega_{sam}}\over{N}}m}，m = 0,1,2,…，N-1
$$

表明了三者的关系，**有限长序列$x[k]$的DFT计算结果$X[m]$是$\widetilde{X}_{\omega_{sam}}(j\omega)$在一个周期里的抽样值，抽样间隔是$\omega_{sam}/N$。**如上图所示。

### 2.5.2 混叠现象

如果连续信号不是带限信号，或者是带限信号但抽样频率选取不当，在连续信号离散化时，就会出现信号频谱的混叠。

两种方法应对 ：
1. 通过低通滤波器，使其近似成为带限信号。

2. 提高抽样频率使之满足频谱不混叠的要求。


方法一：


![方法一](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E6%96%B9%E6%B3%95%E4%B8%80.jpg)



### 2.5.3 泄漏现象

连续信号无限长的情况下，离散化后的序列也无限长，就不能利用DFT来分析了，这时需要对其加窗$w_{N}[k]$截短使之成为有限长序列$x_{N}[k]$，即

$$
x_{N}[k] = x[k]·w_{N}[k]
$$

矩形窗$R_{N}[k]$,频谱为$W_{N}(e^{j\Omega})$



![矩形窗](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E7%9F%A9%E5%BD%A2%E7%AA%97.jpg)

如图，若希望$X_{N}(e^{j\Omega})$更接近$X(e^{j\Omega})$，$W_{N}(e^{j\Omega})$应接近周期冲激函数，即主瓣宽度和旁瓣宽度接近为零，能量主要几种在主瓣，旁瓣能量为零。



![无限长的带限信号的频谱分析](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E6%97%A0%E9%99%90%E9%95%BF%E7%9A%84%E5%B8%A6%E9%99%90%E4%BF%A1%E5%8F%B7%E7%9A%84%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90.jpg)

### 2.5.4 栅栏现象

谱线间隔$\triangle f_{d}$反映了信号频谱分析中的显示分辨率。

由于$X_{N}[m]$是离散序列而无法反映$X_{N}(e^{j\Omega})$抽样点之间的细节，称之为栅栏现象。有时频谱中的某些重要信息恰好就在抽样点之间。

改善现象方法：在序列$x_{N}[k]$后补0，构成一个长度为$L(>N)$的序列$x_{L}[k]$。

就会使得谱线间隔变小，从而提高了分辨率，可以显示更多的细节。



![补0对DFT分析信号频谱的影响](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E8%A1%A50%E5%AF%B9DFT%E5%88%86%E6%9E%90%E4%BF%A1%E5%8F%B7%E9%A2%91%E8%B0%B1%E7%9A%84%E5%BD%B1%E5%93%8D.jpg)

补0只能提高分辨率，如果因为混叠或泄漏导致失真，补0也不能恢复已损失信息。

### 2.5.5 利用DFT进行谱分析的参数选择

1. 根据待分析信号的最高频率$f_{m}$确定信号的抽样频率$f_{sam}$，

$$
f_{sam} \geq 2f_{m}
$$

由抽样间隔$T$与抽样频率$f_{sam}$的关系，可得

$$
T = {{1}\over{f_{sam}}}\geq {{1}\over{2f_{m}}}
$$

2. 根据频率分辨率$\triangle f _ {c}$的要求确定信号的抽样点数N，对于矩形窗则有

$$
N = {{f_{sam}}\over{\triangle f_{c}}}
$$

3. 根据抽样点数N和抽样间隔T，得到此信号抽样的持续时间$T _ {p}$

$$
T_{p} = NT={{N}\over{f_{sam}}} = {{1}\over{\triangle f_{c}}}
$$


4. 根据谱线间隔$\triangle f _ {d}$确定DFT的点数L，即

$$
L = {{f_{sam}\over{\triangle f_{d}}}}
$$

# 第三章 离散傅里叶变换快速算法

对于DFT计算过程太过繁琐，不适用于计算机。故而提出一种新的算法。

铺垫一下：离散傅里叶的变换中都有一个很奇特的符号。

$$
W_{N}^{mk} = e^{-\jmath {{2\pi}\over{N}}mk}
$$

可以发现它的一些性质。

* 作为包含周期的符号，显然是有周期性的。

$$
W_{N}^{mk} = W_{N}^{m(k+N)} = W_{N}^{k(m+N)}
$$


* 对称性。(由虚指数可推出)。

$$
W_{N}^{mk+{{\pi}\over{2}}} = -W_{N}^{mk}\\
(W_{N}^{mk})^{*}=W_{N}^{-mk}
$$

* 可约性

$$
W_{N}^{mk} = W_{N/n}^{mk/n}
$$

## 3.1 基2时间抽取FFT算法

时域顺序被打乱，但频域下顺序是正常的。

从小分组开始配对。

### 原理

将一个长度为$N = 2^{M}$的序列(2的倍数)，不够就补零，按奇偶分成两列。

$$
x_{1}[k] = x[2k]\\
x_{2}[k] = x[2k+1]\\
k = 0,1,2...N/2-1;
$$

> 通过运算，由两个短序列的DFT来合成长序列的DFT。
> 

$$
X[m] = DFT\{x[k]\}= X_{1}[m] +W_{N}^{m}X_{2}[m]\\
$$

> 但是$m$的取值为$0,1,2...N/2-1$。但是原序列的长度为N。所以还少了一部分。发现一对奇偶现在只得到一个合并后值，但其实应该得到两个。
> 

故

$$
X[m] = X_{1}[m] +W_{N}^{m}X_{2}[m]\\
X[m+{{N}\over{2}}] = X_{1}[m] - W_{N}^{m}X_{2}[m]
$$

运算图

![蝶形算法运算流图](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210110144909.jpg)



几个注意点：

1. 第一级，前一半都是偶数项，后一半是奇数项。注意排列顺序。
> 0,1,2,3,4,5,6,7。分一半得到(举例一半) 0，2，4，6。需要继续分，(0，4),(2，6)。

2. 从相邻的一一配对，然后两两配对，再四四配对，依次下去。

3. 结果是正常的顺序。

4. 配对的下面那项，需要一个负号，需要系数。

5. 把最后得到的结果，也按上下平分，发现。奇偶第一项，得到最终结果上下部分的第一项。第二项得第二项。依次类推。

6. 系数中m如何确定？看配对时，上面一项，在自己的奇偶序列中是第几位。

### 复杂度

DFT:$N^{2}$

FFT: ${{log _ {2}^{N}}\over{2N}}$

N越大，算法效果越明显。

### 特点

1. 序列原位运算

每一级的运算结果直接存储在原来的存储器即可。

第二级的运算只需要第一级的输出，不再需要原始输入，所以第一级的输出结果可以将原来的输入直接覆盖，可以节省大量的存储单元。

2. 序列倒序运算

将数据分类排列成想要的顺序，方便输入。
>从低位开始按二进制的0，1分组。0在1上面。

3. 旋转因子分布规律

系数的增加和配对节点之间距离的增加，都比前一级多一倍。




## 3.2 基2频率抽取FFT算法

时域下按正常自然顺序，但是频域顺序被打乱。

从大分组开始配对。

### 原理

类似，直接上公式

$$
x_{1}[k] = x[k]+x[k+N/2]\\
x_{2}[k] = \{x[k]-x[k+N/2] \}\\
k = 0,1,2,...N/2-1;\\
X[2m] = \sum_{k = 0}^{N/2-1}x_{1}[k]W_{N/2}^{mk}\\
X[2m+1] = \sum_{k = 0}^{N/2-1}x_{2}[k]W_{N/2}^{mk}\\
m = 0,1,2...,N/2-1;
$$

运算图


![基2频率抽样流图](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210110152719.jpg)




### 特点

频域最后的顺序看进行了几次蝶形运算，几次运算就基2抽取几次排列。

系数和基2时间一样，看前一项在自己序列第几位，从零开始计数。

## 3.3 基4时间抽取FFT算法

## 3.4 混合基FFT算法

## 3.5 实序列的DFT算法

### 3.5.1 用N点复序列同时计算两个N点实序列

$$
y[k] = x[k]+jh[k]\\
X[m] = {{1}\over{2}}\{Y[m]+Y^{*}[(N-m)_{N}] \}\\
H[m] = {{1}\over{2\jmath}}\{Y[m]-Y^{*}[(N-m)_{N}] \}\\
$$

### 3.5.2 用N点复序列计算一个2N点实序列

将2N长度的序列拆分成两个长度为N的序列。

用一个N长度的复序列同时计算，再通过蝶形算法将其合成。


## 3.6 IDFT的快速计算方法

运算图

![微信图片_20210110160115](%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86.assets/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210110160115.jpg)

对X[m]求IDFT，相当于对$X ^ { * }[m]$求FFT，再取一次共轭，再乘1/N，就可以得到x[k]。
